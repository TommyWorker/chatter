{% import 'common.tpl' as c %}
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Chat Room</title>

  <link href="/static/css/bootstrap/bootstrap.min.css" rel="stylesheet">
  <link href="/static/icon/bootstrap-icons-1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link href="/static/css/custom.css" rel="stylesheet">
  <link href="/static/css/chat.css" rel="stylesheet">

</head>
<body onload="page_init();">
   <!-- 左サイドバー -->
    {{ c.common_sidebar(login_user | default("")) }}

    <!-- メインコンテンツ -->
    <div class="content">
        <div id="div_message_area">
            {% if result=="complete" %}
            <div class="alert alert-success alert-dismissible fade show" role="alert">
            {{sys_msg}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% elif result=="error" %}
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
            {{sys_msg}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% elif result=="info" %}
            <div class="alert alert-info alert-dismissible fade show" role="alert">
            {{sys_msg}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endif %}
        </div>

        <div class="m-3 mb-5 bg-white w-100 border-bottom border-dark row">
            <div class="col-auto">
                <h3>Chat Room</h3>
            </div>
            <div class="col text-end">
                <a href="/room/list"
                    class="btn btn-outline-secondary btn-sm mb-2 px-4">
                    <i class="bi bi-search"></i> 一 覧</a>
                <a href="/room/{{room.id}}/form"
                    class="btn btn-outline-primary btn-sm mb-2 px-4">
                    <i class="bi bi-search"></i> 編 集</a>
            </div>
        </div>
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages"></div>
            <div class="chat-input">
                <form id="chatForm" class="d-flex flex-column">
                    <textarea id="chatInput" class="form-control mb-2" placeholder="メッセージを入力..." rows="2"></textarea>
                </form>
            </div>
        </div>
    </div>

    <!-- Topへ戻るボタン -->
    <button id="scrollToTopBtn" class="btn" type="button"><i class="bi bi-arrow-up"></i></button>

    <!-- 隠しフィールド -->
    <input type="hidden" class="form-control" value="{{room.id or ''}}" id="hdn_room_id" name="hdn_room_id">
    <input type="hidden" class="form-control" value="{{login_user.id or ''}}" id="hdn_user_id" name="hdn_user_id">
    <input type="hidden" class="form-control" value="{{login_user.user_name or ''}}" id="hdn_user_name" name="hdn_user_name">

    <script src="/static/js/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/static/js/common.js"></script>
    <script src="/static/js/chat.js"></script>
</body>
</html>
